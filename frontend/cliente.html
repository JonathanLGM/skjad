<script>
    const backendUrl = "/cliente"; 

    // ... (otras funciones como obtenerClientes, editarCliente, eliminarCliente y limpiarFormulario son las mismas) ...

    const guardarCliente = async () => {
        const id_cliente_val = document.getElementById('id_cliente').value; // Obtén el valor del input oculto

        // Crea el objeto con los datos del cliente
        const clienteData = {
            nombre: document.getElementById('nombre').value,
            apellido: document.getElementById('apellido').value,
            documento: document.getElementById('documento').value,
            telefono: document.getElementById('telefono').value,
            direccion: document.getElementById('direccion').value,
            correo: document.getElementById('correo').value,
            id_barrio: parseInt(document.getElementById('id_barrio').value)
        };

        // Validación básica
        if (!clienteData.nombre || !clienteData.apellido || !clienteData.documento || !clienteData.correo || isNaN(clienteData.id_barrio)) {
            alert('Por favor, completa todos los campos obligatorios (Nombre, Apellido, Documento, Correo, ID Barrio).');
            return;
        }

        let res;
        try {
            if (id_cliente_val) { // Si id_cliente_val tiene un valor, estamos actualizando
                // No necesitas añadir id_cliente al body para PUT, ya va en la URL
                res = await fetch(`${backendUrl}/${id_cliente_val}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(clienteData)
                });
            } else { // Si id_cliente_val está vacío, estamos creando
                // Asegúrate de que id_cliente NO se envíe en el body para POST
                // clienteData ya no incluye id_cliente porque nunca lo pusimos.
                res = await fetch(backendUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(clienteData)
                });
            }

            const result = await res.json();
            if (!res.ok) throw new Error(result.mensaje || `HTTP error! status: ${res.status}`);
            
            alert(result.mensaje);
            limpiarFormulario();
            obtenerClientes();
        } catch (error) {
            console.error("Error al guardar cliente:", error);
            alert("Error al guardar cliente: " + error.message);
        }
    };

    // ... (el resto del script es el mismo) ...

    document.getElementById('guardarBtn').addEventListener('click', guardarCliente);
    obtenerClientes();
</script>